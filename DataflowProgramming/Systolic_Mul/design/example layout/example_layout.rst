
Example Layout
Assume we have a 2D mesh of Pr*Pc PEs

in this case, 4 rows 5 columns
+----------------+----------------+----------------+----------------+----------------+
| PE (0, 0)      | PE (0, 1)      | PE (0, 2)      | PE (0, 3)      | PE (0, 4)      |
|   west north   |  north bridge  |  north bridge  |  north bridge  |  east north    |
+----------------+----------------+----------------+----------------+----------------+
| PE (1, 0)      | PE (1, 1)      | PE (1, 2)      | PE (1, 3)      | PE (1, 4)      |
|   west bridge  |  internal      |  internal      |  internal      |  east bridge   |
+----------------+----------------+----------------+----------------+----------------+
| PE (2, 0)      | PE (2, 1)      | PE (2, 2)      | PE (2, 3)      | PE (2, 4)      |
|   west bridge  |  internal      |  internal      |  internal      |  east bridge   |
+----------------+----------------+----------------+----------------+----------------+
| PE (3, 0)      | PE (3, 1)      | PE (3, 2)      | PE (3, 3)      | PE (3, 4)      |
|   west south   |  south bridge  |  south bridge  |  south bridge  |  east south    |
+----------------+----------------+----------------+----------------+----------------+

Matrix:
A_12*36
B_36*20
C_12*20

The tile size of      A: Mt*Kt: 3*6
The tile size of      B: Kt*Nt: 6*4
The partial result of C: Mt*Nt: 3*4


Matrix A, Blocked, 4*6 on host
The tile size of A: 3*6
+-----------+-----------+-----------+-----------+-----------+-----------+
| A (0, 0)  | A (0, 1)  | A (0, 2)  | A (0, 3)  | A (0, 4)  | A (0, 5)  |
+-----------+-----------+-----------+-----------+-----------+-----------+
| A (1, 0)  | A (1, 1)  | A (1, 2)  | A (1, 3)  | A (1, 4)  | A (1, 5)  |
+-----------+-----------+-----------+-----------+-----------+-----------+
| A (2, 0)  | A (2, 1)  | A (2, 2)  | A (2, 3)  | A (2, 4)  | A (2, 5)  |
+-----------+-----------+-----------+-----------+-----------+-----------+
| A (3, 0)  | A (3, 1)  | A (3, 2)  | A (3, 3)  | A (3, 4)  | A (3, 5)  |
+-----------+-----------+-----------+-----------+-----------+-----------+ 


Matrix B, Blocked, 6*5 on host
The tile size of B: 6*4
+-----------+-----------+-----------+-----------+-----------+
| B (0, 0)  | B (0, 1)  | B (0, 2)  | B (0, 3)  | B (0, 4)  |
+-----------+-----------+-----------+-----------+-----------+
| B (1, 0)  | B (1, 1)  | B (1, 2)  | B (1, 3)  | B (1, 4)  |
+-----------+-----------+-----------+-----------+-----------+
| B (2, 0)  | B (2, 1)  | B (2, 2)  | B (2, 3)  | B (2, 4)  |
+-----------+-----------+-----------+-----------+-----------+
| B (3, 0)  | B (3, 1)  | B (3, 2)  | B (3, 3)  | B (3, 4)  |
+-----------+-----------+-----------+-----------+-----------+
| B (4, 0)  | B (4, 1)  | B (4, 2)  | B (4, 3)  | B (4, 4)  |
+-----------+-----------+-----------+-----------+-----------+
| B (5, 0)  | B (5, 1)  | B (5, 2)  | B (5, 3)  | B (5, 4)  |
+-----------+-----------+-----------+-----------+-----------+


For each PE, we give it a tile of A and a tile of B, in a systolic pattern, th PEs will compute local result C = AB

   
                                                                                                                                                                                    +----------------+
                                                                                                                                                                                    | B (5, 4)       |
                                                                                                                                                                                    |                |
                                                                                                                                                                   +----------------+----------------+
                                                                                                                                                                   | B (5, 3)       | B (4, 4)       |
                                                                                                                                                                   |                |                |
                                                                                                                                                  +----------------+----------------+----------------+
                                                                                                                                                  | B (5, 2)       | B (4, 3)       | B (3, 4)       |
                                                                                                                                                  |                |                |                |
                                                                                                                                 +----------------+----------------+----------------+----------------+
                                                                                                                                 | B (5, 1)       | B (4, 2)       | B (3, 3)       | B (2, 4)       |
                                                                                                                                 |                |                |                |                |
                                                                                                                +----------------+----------------+----------------+----------------+----------------+
                                                                                                                | B (5, 0)       | B (4, 1)       | B (3, 2)       | B (2, 3)       | B (1, 4)       |
                                                                                                                |                |                |                |                |                |
                                                                                                                +----------------+----------------+----------------+----------------+----------------+
                                                                                                                | B (4, 0)       | B (3, 1)       | B (2, 2)       | B (1, 3)       | B (0, 4)       |
                                                                                                                |                |                |                |                |                |
                                                                                                                +----------------+----------------+----------------+----------------+----------------+
                                                                                                                | B (3, 0)       | B (2, 1)       | B (1, 2)       | B (0, 3)       | 
                                                                                                                |                |                |                |                | 
                                                                                                                +----------------+----------------+----------------+----------------+
                                            ----------->                                                        | B (2, 0)       | B (1, 1)       | B (0, 2)       |  
                                                                                                                |                |                |                | 
                                                                                                                +----------------+----------------+----------------+
                                                                                                                | B (1, 0)       | B (0, 1)       |
                                                                                                                |                |                |
                                                                                                                +----------------+----------------+
                                                                                                                | B (0, 0)       |
                                                                                                                | b11
                                                                                                                  b21
                                                                                                                  b31            |
                                                                                                                +----------------+
                                                                                                                ######################################################################################
                                                                                                     10*10      ######################################################################################
                                    +-----------+-----------+-----------+-----------+-----------+-----------+## +----------------+----------------+----------------+----------------+----------------+
                                    | A (0, 5)  | A (0, 4)  | A (0, 3)  | A (0, 2)  | A (0, 1)  | A (0, 0)  |## | PE (1, 1)      | PE (1, 2)      | PE (1, 3)      | PE (1, 4)      | PE (1, 5)      |
                                    |           |           |           |           |           |  a11 a12  |## |   west north   |  north bridge  |  north bridge  |  north bridge  |  east north    |
                        +-----------+-----------+-----------+-----------+-----------+-----------+-----------+## +----------------+----------------+----------------+----------------+----------------+
                        | A (1, 5)  | A (1, 4)  | A (1, 3)  | A (1, 2)  | A (1, 1)  | A (1, 0)  |           |## | PE (2, 1)      | PE (2, 2)      | PE (2, 3)      | PE (2, 4)      | PE (2, 5)      |
                        |           |           |           |           |           |           |           |## |   west bridge  |  internal      |  internal      |  internal      |  east bridge   |
            +-----------+-----------+-----------+-----------+-----------+-----------+-----------+           +## +----------------+----------------+----------------+----------------+----------------+
            | A (2, 5)  | A (2, 4)  | A (2, 3)  | A (2, 2)  | A (2, 1)  | A (2, 0)  |                       |## | PE (3, 1)      | PE (3, 2)      | PE (3, 3)      | PE (3, 4)      | PE (3, 5)      |
            |           |           |           |           |           |           |                       |## |   west bridge  |  internal      |  internal      |  internal      |  east bridge   |
+-----------+-----------+-----------+-----------+-----------+-----------+-----------+                       +## +----------------+----------------+----------------+----------------+----------------+
| A (3, 5)  | A (3, 4)  | A (3, 3)  | A (3, 2)  | A (3, 1)  | A (3, 0)  |                                   |## | PE (4, 1)      | PE (4, 2)      | PE (4, 3)      | PE (4, 4)      | PE (4, 5)      |
|           |           |           |           |           |           |                                   |## |   west south   |  south bridge  |  south bridge  |  south bridge  |  east south    |
+-----------+-----------+-----------+-----------+-----------+-----------+                                   +## +----------------+----------------+----------------+----------------+----------------+



